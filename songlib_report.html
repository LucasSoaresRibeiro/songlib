
    <!DOCTYPE html>
    <html>
    <head>
        <title>IBM - Estatísticas do Louvor</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="web/style/styles-report.css">
        <link href="https://fonts.googleapis.com/css2?family=Martian+Mono:wdth,wght@87.5,100..800&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    </head>
    <body>
        <div class="logo-container">
            <img src="images/logo.png" alt="Maranata Logo" class="logo" />
        </div>
        <h1>Estatísticas do Ministério de Louvor</h1>

        <div class="container">
            <h2>Resumo:</h2>
            <div class="dashboard-container">
                <div class="dashboard-block">
                    <div class="dashboard-block-title">Período Analisado</div>
                    <div class="dashboard-block-value">11/08/2024 a 27/07/2025</div>
                </div>
                <div class="dashboard-block">
                    <div class="dashboard-block-title">Músicas Cadastradas</div>
                    <div class="dashboard-block-value">184</div>
                </div>
                <div class="dashboard-block">
                    <div class="dashboard-block-title">Cultos e Programações</div>
                    <div class="dashboard-block-value">64</div>
                </div>
                <div class="dashboard-block">
                    <div class="dashboard-block-title">Média de Músicas por Programação</div>
                    <div class="dashboard-block-value">6</div>
                </div>
                <div class="dashboard-block">
                    <div class="dashboard-block-title">Total de Execuções de Música</div>
                    <div class="dashboard-block-value">380</div>
                </div>
            </div>
        </div>

        <div class="container">
            <h2>Músicas Mais Cantadas</h2>
            <canvas id="topSongsChart"></canvas>
        </div>

        <div class="container" style="display: none;">
            <h2>Músicas Cadastradas Menos Cantadas</h2>
            <canvas id="leastUsedSongsChart"></canvas>
        </div>

        <div class="container">
            <h2>Autores/Intérpretes Mais Frequentes</h2>
            <canvas id="topAuthorsChart"></canvas>
        </div>


        <div class="container">
            <h2>Músicas Mais Escolhidas como Início do Louvor</h2>
            <canvas id="firstSongsChart"></canvas>
        </div>

        <div class="container">
            <h2>Músicas Mais Escolhidas como Final do Louvor</h2>
            <canvas id="lastSongsChart"></canvas>
        </div>
        
        <div class="container">
            <h2>Músicas Mais Escolhidas para Oferta</h2>
            <canvas id="offeringSongsChart"></canvas>
        </div>

        <div class="container">
            <h2>Músicas Mais Escolhidas para Pão</h2>
            <canvas id="breadSongsChart"></canvas>
        </div>

        <div class="container">
            <h2>Músicas Mais Escolhidas para Cálice</h2>
            <canvas id="wineSongsChart"></canvas>
        </div>

        <div class="container">
            <h2>Cultos por Dirigente</h2>
            <canvas id="singersChart"></canvas>
        </div>

        <div class="container-limited-height">
            <h2>Tonalidades Preferidas por Dirigente</h2>
            <canvas id="singerKeysChart"></canvas>
        </div>

        <div class="container">
            <h2>Top 10 Músicas por Dirigente</h2>
            <canvas id="singerTopSongsChart"></canvas>
        </div>

        <div class="container">
            <h2>Clima por Dirigente</h2>
            <canvas id="weatherBySingerChart"></canvas>
        </div>

        <script>
            // Data for Singers Chart
            const singersData = {
                labels: ["Daniel", "Pompeu", "Theo", "Eric", "Geraldo"],
                datasets: [{
                    label: 'Quantidade',
                    data: [15, 13, 12, 10, 7],
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            };

            const singersCtx = document.getElementById('singersChart').getContext('2d');
            new Chart(singersCtx, {
                type: 'bar',
                data: singersData,
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'start',
                            formatter: (value, context) => {
                                return value;
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });



            // Data for Top Songs Chart
            const topSongsData = {
                labels: ["Vem Glorificar a Deus", "Reden\u00e7\u00e3o", "Glorificar", "Senhor Tu \u00c9s Bom", "Eu Te Louvarei Meu Bom Jesus", "Grande e Eterno Deus", "Perto Quero Estar (Te Louvarei)", "Bondade de Deus", "\u00c9 Teu Povo (IPALPHA)", "Eu Sou Grato (Tributo a Yehovah)"],
                datasets: [{
                    label: 'Quantidade',
                    data: [11, 8, 7, 6, 6, 6, 6, 6, 6, 5],
                    backgroundColor: 'rgba(153, 102, 255, 0.6)',
                    borderColor: 'rgba(153, 102, 255, 1)',
                    borderWidth: 1
                }]
            };

            const topSongsCtx = document.getElementById('topSongsChart').getContext('2d');
            new Chart(topSongsCtx, {
                type: 'bar',
                data: topSongsData,
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'start',
                            formatter: (value, context) => {
                                return value;
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Data for Top First Songs Chart
            const firstSongsData = {
                labels: ["Senhor Tu \u00c9s Bom", "Somos Convidados", "Salvo Pela Gra\u00e7a", "Vem Glorificar a Deus", "Reden\u00e7\u00e3o", "Ao Deus de Abra\u00e3o Louvai", "Eu Te Louvarei Meu Bom Jesus", "Aleluia, Hosana", "Grande e Eterno Deus", "Cantai Perto Est\u00e1 o Senhor"],
                datasets: [{
                    label: 'Quantidade',
                    data: [5, 4, 4, 4, 3, 3, 3, 3, 3, 3],
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1
                }]
            };

            const firstSongsCtx = document.getElementById('firstSongsChart').getContext('2d');
            new Chart(firstSongsCtx, {
                type: 'bar',
                data: firstSongsData,
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'start',
                            formatter: (value, context) => {
                                return value;
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Data for Top Last Songs Chart
            const lastSongsData = {
                labels: ["Marcharemos", "Amigo de Deus", "Perto Quero Estar (Te Louvarei)", "S\u00f3 em Jesus (Confiarei)", "Fala \u00d3 Deus (Vers\u00e3o Baixo/Guitarra)", "Isa\u00edas 53", "Ao \u00danico", "Ele Me Guardar\u00e1", "N\u00e3o Tenhas Sobre Ti", "At\u00e9 Te Ver Face a Face"],
                datasets: [{
                    label: 'Quantidade',
                    data: [5, 3, 3, 2, 2, 2, 2, 2, 2, 1],
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            };

            const lastSongsCtx = document.getElementById('lastSongsChart').getContext('2d');
            new Chart(lastSongsCtx, {
                type: 'bar',
                data: lastSongsData,
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'start',
                            formatter: (value, context) => {
                                return value;
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Data for Top Authors Chart
            const topAuthorsData = {
                labels: ["Vineyard", "Paulo C\u00e9sar Baruk", "Projeto Sola", "Fernandinho", "IPALPHA", "Gracia Soberana M\u00fasica", "Hin\u00e1rio para o Culto Crist\u00e3o (HCC)", "Cantor Crist\u00e3o", "Chris Tomlin", "Daniel Souza"],
                datasets: [{
                    label: 'Quantidade',
                    data: [26, 20, 19, 11, 11, 11, 11, 11, 9, 9],
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1
                }]
            };

            const topAuthorsCtx = document.getElementById('topAuthorsChart').getContext('2d');
            new Chart(topAuthorsCtx, {
                type: 'bar',
                data: topAuthorsData,
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'start',
                            formatter: (value, context) => {
                                return value;
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Data for Singer Keys Chart
            const singerKeysData = {
                labels: ["A", "A# / Bb", "B", "C", "C# / Db", "D", "E", "F", "F# / Gb", "G", "G# / Ab"],
                datasets: [{"label": "Geraldo", "data": [4, 6, 2, 5, 0, 9, 8, 0, 0, 8, 0], "backgroundColor": "rgba(40, 92, 251, 0.6)", "borderColor": "rgba(40, 92, 251, 1)", "borderWidth": 1}, {"label": "Eric", "data": [14, 5, 1, 7, 0, 12, 9, 5, 0, 9, 0], "backgroundColor": "rgba(232, 224, 1, 0.6)", "borderColor": "rgba(232, 224, 1, 1)", "borderWidth": 1}, {"label": "Theo", "data": [10, 5, 3, 14, 1, 17, 11, 2, 0, 8, 0], "backgroundColor": "rgba(194, 1, 28, 0.6)", "borderColor": "rgba(194, 1, 28, 1)", "borderWidth": 1}, {"label": "Daniel", "data": [6, 10, 1, 16, 0, 15, 10, 7, 1, 19, 2], "backgroundColor": "rgba(252, 221, 127, 0.6)", "borderColor": "rgba(252, 221, 127, 1)", "borderWidth": 1}, {"label": "Pompeu", "data": [14, 5, 0, 12, 0, 11, 13, 0, 1, 13, 0], "backgroundColor": "rgba(131, 77, 100, 0.6)", "borderColor": "rgba(131, 77, 100, 1)", "borderWidth": 1}]
            };

            const singerKeysCtx = document.getElementById('singerKeysChart').getContext('2d');
            new Chart(singerKeysCtx, {
                type: 'radar',
                data: singerKeysData,
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'start',
                            formatter: (value, context) => {
                                return value;
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Data for Offering Songs Chart
            const offeringSongsData = {"labels": ["Meu Tributo (Como Agradecer)", "Gra\u00e7as Senhor (Gra\u00e7as Dou)", "Eu Sou Grato (Tributo a Yehovah)", "Te Agrade\u00e7o (Tradicional)", "Rei das Na\u00e7\u00f5es (Grandes S\u00e3o as Tuas Obras)", "Gra\u00e7as Dou", "Meu Prazer (Em Esp\u00edrito)", "Glorificar", "Deus Forte", "Senhor Te Quero"], "datasets": [{"label": "Quantidade", "data": [3, 3, 3, 2, 2, 2, 1, 1, 1, 1], "backgroundColor": "rgba(255, 159, 64, 0.6)", "borderColor": "rgba(255, 159, 64, 1)", "borderWidth": 1}]};

            const offeringSongsCtx = document.getElementById('offeringSongsChart').getContext('2d');
            new Chart(offeringSongsCtx, {
                type: 'bar',
                data: offeringSongsData,
                options: {"responsive": true, "indexAxis": "y", "plugins": {"datalabels": {"anchor": "end", "align": "start", "formatter": "(value, context) => { return value; }"}}, "scales": {"x": {"beginAtZero": true}}}
            });

            // Data for Bread Songs Chart
            const breadSongsData = {"labels": ["Foi na Cruz", "Por Isso Reina (O Rei da Gl\u00f3ria)", "Alto Pre\u00e7o", "Maior Que Tudo", "Vinho e P\u00e3o", "Comunh\u00e3o", "P\u00e3o da Vida (Cristo Levou Sobre Si)", "Jesus Cristo Mudou Meu Viver"], "datasets": [{"label": "Quantidade", "data": [2, 2, 1, 1, 1, 1, 1, 1], "backgroundColor": "rgba(75, 192, 192, 0.6)", "borderColor": "rgba(75, 192, 192, 1)", "borderWidth": 1}]};

            const breadSongsCtx = document.getElementById('breadSongsChart').getContext('2d');
            new Chart(breadSongsCtx, {
                type: 'bar',
                data: breadSongsData,
                options: {"responsive": true, "indexAxis": "y", "plugins": {"datalabels": {"anchor": "end", "align": "start", "formatter": "(value, context) => { return value; }"}}, "scales": {"x": {"beginAtZero": true}}}
            });

            // Data for Wine Songs Chart
            const wineSongsData = {"labels": ["Digno \u00c9 o Senhor", "Isa\u00edas 53", "Poder pra Salvar", "N\u00e3o Mais Eu Mas Por Cristo em Mim (Mod.)", "Prosto-me Diante da Cruz", "Alto Pre\u00e7o", "Tua Gra\u00e7a me Basta", "Nada Al\u00e9m do Sangue"], "datasets": [{"label": "Quantidade", "data": [2, 2, 2, 1, 1, 1, 1, 1], "backgroundColor": "rgba(153, 102, 255, 0.6)", "borderColor": "rgba(153, 102, 255, 1)", "borderWidth": 1}]};

            const wineSongsCtx = document.getElementById('wineSongsChart').getContext('2d');
            new Chart(wineSongsCtx, {
                type: 'bar',
                data: wineSongsData,
                options: {"responsive": true, "indexAxis": "y", "plugins": {"datalabels": {"anchor": "end", "align": "start", "formatter": "(value, context) => { return value; }"}}, "scales": {"x": {"beginAtZero": true}}}
            });

            // Data for Least Used Songs Chart
            const leastUsedSongsData = {"labels": ["At\u00e9 Te Ver Face a Face", "Deus est\u00e1 aqui", "N\u00e3o H\u00e1 Deus Maior", "Que Alegria Neste Dia (HCC 611)", "Saudai o Nome de Jesus (HCC 56)", "Clamo Jesus", "Deus Forte", "Senhor Te Quero", "Deus Eu Te Exaltarei", "Grandioso \u00c9s Tu"], "datasets": [{"label": "Quantidade", "data": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "backgroundColor": "rgba(255, 206, 86, 0.6)", "borderColor": "rgba(255, 206, 86, 1)", "borderWidth": 1}]};

            const leastUsedSongsCtx = document.getElementById('leastUsedSongsChart').getContext('2d');
            new Chart(leastUsedSongsCtx, {
                type: 'bar',
                data: leastUsedSongsData,
                options: {"responsive": true, "indexAxis": "y", "plugins": {"datalabels": {"anchor": "end", "align": "start", "formatter": "(value, context) => { return value; }"}}, "scales": {"x": {"beginAtZero": true}}}
            });

            // Data for Singer Top Songs Chart
            const singerTopSongsData = {"Geraldo": [["Reden\u00e7\u00e3o", 2], ["Eu Sou Grato (Tributo a Yehovah)", 2], ["N\u00e3o Mais Eu Mas Por Cristo em Mim", 2], ["Santo, Santo (Vineyard)", 2], ["Jesus me Transformou", 1], ["Meu Prazer (Em Esp\u00edrito)", 1], ["At\u00e9 Te Ver Face a Face", 1], ["Teu nome \u00e9 Santo", 1], ["Ajuntamento", 1], ["Oferta de amor", 1]], "Eric": [["Cantai Perto Est\u00e1 o Senhor", 2], ["Ele \u00c9 Exaltado", 2], ["Gra\u00e7as Senhor (Gra\u00e7as Dou)", 2], ["Poder pra Salvar", 2], ["Gra\u00e7as Dou", 2], ["Jesus \u00c9 O Rei da Gl\u00f3ria (Todo Poder)", 2], ["Teu Amor N\u00e3o Falha", 1], ["Te Agrade\u00e7o (Tradicional)", 1], ["Isa\u00edas 53", 1], ["Alvo Mais Que a Neve (Livro 2003)", 1]], "Theo": [["Grande e Eterno Deus", 3], ["Gra\u00e7as Senhor (Gra\u00e7as Dou)", 2], ["Perto Quero Estar (Te Louvarei)", 2], ["Reina", 2], ["Perd\u00e3o e Gra\u00e7a", 2], ["Eu Te Louvarei Meu Bom Jesus", 2], ["Somos Convidados", 2], ["No Controle Tu Est\u00e1s", 2], ["Tu Somente \u00c9s Deus", 2], ["S\u00f3 em Jesus (Confiarei)", 2]], "Daniel": [["Vem Glorificar a Deus", 3], ["Ao Deus de Abra\u00e3o Louvai", 2], ["Senhor Tu \u00c9s Bom", 2], ["Eu Te Louvarei Meu Bom Jesus", 2], ["Meu Tributo (Como Agradecer)", 2], ["S\u00f3 em Jesus (Confiarei)", 2], ["Fala \u00d3 Deus (Vers\u00e3o Baixo/Guitarra)", 2], ["Se N\u00e3o For Pra Te Adorar", 2], ["Alto Pre\u00e7o", 2], ["Digno \u00c9 o Senhor", 2]], "Pompeu": [["Rei das Na\u00e7\u00f5es (Grandes S\u00e3o as Tuas Obras)", 3], ["Perto Quero Estar (Te Louvarei)", 2], ["Foi na Cruz", 2], ["Aleluia, Hosana", 2], ["Firmeza na F\u00e9", 2], ["Vem Glorificar a Deus", 2], ["Senhor Tu \u00c9s Bom", 2], ["Firme nas Promessas (CC 154)", 2], ["Salvo Pela Gra\u00e7a", 2], ["Teu Amor \u00c9 Incr\u00edvel (Phillips, Craig & Dean)", 2]]};
            const singerTopSongsContainer = document.getElementById('singerTopSongsChart');
            
            for (const singerName in singerTopSongsData) {
                const songs = singerTopSongsData[singerName];
                if (songs.length > 0) {
                    const chartDiv = document.createElement('div');
                    chartDiv.className = 'singer-top-songs-chart';
                    chartDiv.innerHTML = `<h3>${singerName}</h3><canvas id="singerTopSongsChart_${singerName}"></canvas>`;
                    singerTopSongsContainer.parentNode.insertBefore(chartDiv, singerTopSongsContainer);

                    const ctx = document.getElementById(`singerTopSongsChart_${singerName}`).getContext('2d');
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: songs.map(item => item[0]),
                            datasets: [{
                                label: 'Quantidade',
                                data: songs.map(item => item[1]),
                                backgroundColor: 'rgba(75, 192, 192, 0.6)',
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            indexAxis: 'y',
                            plugins: {
                                datalabels: {
                                    anchor: 'end',
                                    align: 'start',
                                    formatter: (value, context) => {
                                        return value;
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                }
            }
            singerTopSongsContainer.remove();
            // Data for Weather by Singer Chart
            const weatherBySingerData = {"Geraldo": {"rain": 1, "no_rain": 6}, "Daniel": {"rain": 6, "no_rain": 8}, "Theo": {"rain": 8, "no_rain": 4}, "Pompeu": {"rain": 6, "no_rain": 6}, "Eric": {"rain": 8, "no_rain": 2}};
            const weatherLabels = Object.keys(weatherBySingerData);
            const rainData = weatherLabels.map(singer => weatherBySingerData[singer]['rain']);
            const noRainData = weatherLabels.map(singer => weatherBySingerData[singer]['no_rain']);

            const weatherCtx = document.getElementById('weatherBySingerChart').getContext('2d');
            new Chart(weatherCtx, {
                type: 'bar',
                data: {
                    labels: weatherLabels,
                    datasets: [
                        {
                            label: 'Choveu',
                            data: rainData,
                            backgroundColor: 'rgba(75, 192, 192, 0.6)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Não Choveu',
                            data: noRainData,
                            backgroundColor: 'rgba(255, 99, 132, 0.6)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            stacked: true,
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        datalabels: {
                            formatter: (value, context) => {
                                return value > 0 ? value : '';
                            }
                        }
                    }
                }
            });
        </script>
    </body>
    </html>
    